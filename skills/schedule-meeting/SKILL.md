---
name: schedule-meeting
description: Use this skill when user asks to "schedule a meeting", "договорись о встрече", "назначь встречу", "согласуй время встречи", "meet with someone", or mentions scheduling time with another person.
tools: Read, Bash
---

# Schedule Meeting

## Algorithm

# Schedule Meeting

Согласование встречи с пользователем через cross-session communication.

## Algorithm

### 1. Parse Request

Из запроса извлеки:
- **Участник**: @username, имя или ID
- **Временные слоты**: диапазон времени владельца (например "12:00-20:00")
- **Дата**: если указана, иначе "завтра"
- **Цель**: если указана

### 2. Find User

```
resolve_user("@masha")
```

Если не найден — сообщи владельцу.

### 3. Create Conversation Task

Первое сообщение ВСЕГДА в таком формате:

```
Привет! Я личный ассистент @qanelph. Он предлагает созвониться {дата} с {время_от} до {время_до} по МСК{цель, если есть}. Подскажи, в какое время тебе удобнее?
```

Примеры:
- "Привет! Я личный ассистент @qanelph. Он предлагает созвониться завтра с 12:00 до 20:00 по МСК. Подскажи, в какое время тебе удобнее?"
- "Привет! Я личный ассистент @qanelph. Он предлагает созвониться в четверг с 14:00 до 18:00 по МСК, обсудить проект. Подскажи, в какое время тебе удобнее?"

```
start_conversation(
  user="@masha",
  task_type="meeting",
  title="Встреча {дата}",
  context="date: {дата}, owner_slots: {слоты}, purpose: {цель если есть}",
  initial_message="Привет! Я личный ассистент @qanelph. Он предлагает созвониться {дата} с {от} до {до} по МСК. Подскажи, в какое время тебе удобнее?"
)
```

### 4. Wait for Result

Результат придёт автоматически через уведомление.

### 5. Handle Responses

**Если человек выбрал время:**
1. Сообщи владельцу: "Встреча с @masha согласована на {дата} в {время} МСК"
2. Создай напоминание за 5 минут:
```
schedule_task(
  prompt="Встреча с @masha через 5 минут. Используй скилл create-telemost чтобы создать ссылку Яндекс Телемост, затем отправь ссылку @qanelph и @masha.",
  time="{согласованное время минус 5 минут}",
  repeat="None"
)
```

**Если человек не отвечает (прошло >2 часов):**
- Пропинговать: "Жду время на встречу, подскажешь?"

**Если отказ или предлагает другое время:**
1. Собрать все предложенные варианты от человека
2. Ответить ему: "Понял, вернусь когда согласую с @qanelph"
3. Сообщить владельцу: "Время {слоты} не подходит @masha. Предлагает: {варианты}. Какой выбираем?"
4. После ответа владельца — вернуться к человеку с подтверждением

**Если полный отказ (не может/не хочет):**
1. Ответить: "Понял, спасибо!"
2. Сообщить владельцу: "@masha не может встретиться. Причина: {если указана}"

## User Session Instructions

Ты помогаешь согласовать время встречи от имени @qanelph.

### Правила
- Будь кратким и вежливым
- Не предлагай время вне указанных слотов
- Если пользователь называет конкретное время — подтверди и заверши
- Если пользователь предлагает другое время/дату — запиши все варианты и скажи что согласуешь с @qanelph
- Если пользователь отказывается — не настаивай

### Завершение
Когда время согласовано:
```
update_conversation(task_id="...", status="completed", result="confirmed: {время}, {дата}")
```

Когда нужно пересогласование:
```
update_conversation(task_id="...", status="pending", result="user_suggests: {варианты}")
```

Когда отказ:
```
update_conversation(task_id="...", status="cancelled", result="reason: {причина}")
```
